#!/bin/bash

# author: Thato Semoko
# email: thatosmk@gmail.com

# options are either 'new' or 'open'
if [ $1 == "new" ]; then 

	# create a new directory
	mkdir $3

	if [ $2 == "blank" ]; then 
		# copy in a template(main.tex and makefile) - blank document
		cp ~/.appa/src/blank/* $3
        cp ~/.appa/src/macros/* $3

	elif [ $2 == "science" ]; then 
		# copy in a template(main.tex and makefile) - technical paper
		cp ~/.appa/src/science/* $3
        cp ~/.appa/src/macros/* $3

    # include slides functionality with Beamer
    elif [ $2 == "prezi" ]; then
       # copy slides templates - slides
       cp ~/.appa/src/prezi/* $3
       cp ~/.appa/src/macros/* $3
	fi

    cd $3
    

	# run make for the pdf file 
	make
    # clean the build

    # open the pdf file
    xdg-open *.pdf 

    # run the latexmk in a new terminal  
    gnome-terminal -x sh -c "latexmk -pvc -pdf main.tex; zsh"

    # open vi with the tex file
    gnome-terminal -x sh -c "vi main.tex; zsh"

elif [ $1 == "open" ]; then 

    # compile
    make clean && make

    # open the pdf file
    xdg-open *.pdf 

    # run the latexmk in a new terminal  
    gnome-terminal -x sh -c "latexmk -pvc -pdf $2; zsh"

    # open vi with the tex file
    gnome-terminal -x sh -c "vi $2; zsh"

fi

